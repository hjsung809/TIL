# 람다식

함수적 프로그래밍이 부각된 이후, 자바 8에서 부터 람다식이 지원된다.

람다식은 함수적 인터페이스에 대해 '익명함수를 생성하기 위한 식' 이라고 봐도 된다.  익명 객체를 활용하기 때문이다.

```java
@FunctionalInterface
public interface MyFunctionalInterface {
	public void method();
}
```

위와 같이 추상 메소드가 하나 선언된 인터페이스를 함수적 인터페이스라고하며, 람다식의 타겟이 될 수 있다.



```java
MyFunctionalInterface fi = () -> {}
```

위 처럼 함수적 인터페이스를 생성할 수 있는 간단한 표현이라고 볼 수 있는 것이다.



## 클래스 멤버와 로컬 변수

람다식의 실행 블록에는 클래스의 멤버는 제약 사항 없이 사용 가능하지만, 로컬 변수는 제약 사항이 따른다.

### 클래스 멤버

람다식 내부에서 this 키워드는 일반적인 익명 객체가 자기 자신을 의미하는 것과 달리, 람다식을 실행한 객체를 참조한다.

### 로컬 변수

람다식은 메소드 내부에서 주로 작성되기 때문에 로컬 익명 구현 객체를 생성시킨다고 봐야한다. 바깥 클래스의 필드나 메소드는 제한 없이 사용할 수 있으나, 메소드의 매개 변수나 로컬변수를 사용하려면 그 변수가 final 특성을 가져야한다.



## 표준 API의 함수적 인터페이스

자바 8부터 빈번하게 사용되는 함수적 인터페이스는 java.util.function의 표준 API 패키지로 제공된다. 크게 5개의 종류가 있다.

- Consumer: 매개 값은 있고 리턴 값이 없다.  => void accept(T t);
- Supplier: 매개 값은 없고 리턴 값이 있다.     => T get();
- Function: 매개 값도 있고 리턴 값도 있다. 주로 매개 값을 리턴 값으로 매핑하는데 사용된다. => R apply(V);
- Operator: 매개 값도 있고 리턴 값도 있다. 주로 매개 값을 연산하고 결과를 리턴한다. => T apply(T); , T apply(T, T);
- Predicate: 매개 값이 있고, 리턴 값이 boolean 타입으로 있다. 필터링 하는데 사용된다.  => boolean test(T);, boolean test(T, U);

각 인터페이스들은 하위 인터페이스들을 가지고 용도에 맞게 쓰인다.



### andThen(), compose()

Consumer, Function, Operator 종류의 함수적 인터페이스는 andThen() 과 compose() 디폴트 메소드를 가지고 있다. 이를 이용해서 두개의 함수적 인터페이스를 순차적으로 연결한 인터페이스를 만들 수 있다.

```java
인터페이스AB = 인터페이스A.andThen(인터페이스B);
result = 인터페이스AB.method();
```

andThen과 compose의 차이는 andThen은 앞의 인터페이스부터, compose는 그 반대부터 라는것이다.

comsumer의 경우 andThen() 메서드만 가지고 있으며 전달된 매개 변수를 여러 컨슈머에서 순차적으로 사용한다.

function 의 경우 앞선 인터페이스의 실행결과를 이후의 인터페이스의 매개변수로 준다. 파이프 라이닝이 가능하다는 것이다.

operator의 경우 function과 비슷한데 파이프 라인 중간단계의 타입이 항상 동일한 특성이 있다.

### and(), or(), negate()

Predicate 인터페이스에는 논리연산을 뜻하는 and(), or(), nagate() 함수가 있다. 각각 &&, ||, ! 와 대응된다. 이 함수도 andThen()과 같이 합쳐진 인터페이스를 만드는데 사용된다.

```java
인터페이스AB=인터페이스A.and(인터페이스B);
result = 인터페이스AB.test(입력);
```





## 메소드 참조

메소드 참조(Method References)는 메소드를 참조해서 사용할 수 있는 기능이다.

```java
(left, right) -> Math.max(left, right);
```

위와 같은 형식의 람다식을 작성하는대신, 아래처럼 간단히 함수를 참조하여 사용할 수 있다는 것이다.

```java
Math::max;
```

참고로 이 함수는 2개의 int 매개 값을 받아 int 값을 리턴함으로 IntBinaryOperator 인터페에스 타입에 대입가능하다.



## 생성자 참조

생성자를 참조한다는 것은 객체 생성을 의미한다. 단순히 객체를 생성하고 리턴하도록 구성된 람다식을 생성자 참조로 대신할 수 있다.

```java
(a, b) -> { return new ClassA(a,b); }
Class::new
```

생성자가 여러개 오버 로딩 되어 있을경우 컴파일러가 함수적 인터페이스의 추상 메소드와 동일한 매개 변수 타입과 개수를 가지고 적절한 생성자를 찾아 실행해 준다. 없으면 에러가 밠생한다.